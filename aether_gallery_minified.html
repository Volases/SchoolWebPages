<!DOCTYPE html><html lang="es"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Aether Gallery - Tu Galería Inteligente</title><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet"><script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script><style>:root{--font-main:'Inter',sans-serif;--bg-color-dark:#0A0A10;--text-color-dark:#E0E0E0;--text-muted-dark:#888;--accent-color-1-dark:#3F51B5;--accent-color-2-dark:#2196F3;--accent-color-3-dark:#00BCD4;--glass-bg-dark:rgba(20, 20, 30, 0.4);--border-color-dark:rgba(255, 255, 255, 0.1);--glow-color-dark:rgba(33, 150, 243, 0.5);--bg-color-light:#f5f5f7;--text-color-light:#1d1d1f;--text-muted-light:#6e6e73;--accent-color-1-light:#3b82f6;--accent-color-2-light:#8b5cf6;--accent-color-3-light:#ec4899;--glass-bg-light:rgba(255, 255, 255, 0.6);--border-color-light:rgba(0, 0, 0, 0.1);--glow-color-light:rgba(139, 92, 246, 0.3)}[data-theme=dark]{--bg-color:var(--bg-color-dark);--text-color:var(--text-color-dark);--text-muted:var(--text-muted-dark);--accent-color-1:var(--accent-color-1-dark);--accent-color-2:var(--accent-color-2-dark);--accent-color-3:var(--accent-color-3-dark);--glass-bg:var(--glass-bg-dark);--border-color:var(--border-color-dark);--glow-color:var(--glow-color-dark)}[data-theme=light]{--bg-color:var(--bg-color-light);--text-color:var(--text-color-light);--text-muted:var(--text-muted-light);--accent-color-1:var(--accent-color-1-light);--accent-color-2:var(--accent-color-2-light);--accent-color-3:var(--accent-color-3-light);--glass-bg:var(--glass-bg-light);--border-color:var(--border-color-light);--glow-color:var(--glow-color-light)}*,::after,::before{box-sizing:border-box;margin:0;padding:0}html{scroll-behavior:smooth}body{font-family:var(--font-main);background-color:var(--bg-color);color:var(--text-color);transition:background-color .3s ease,color .3s ease;overflow-x:hidden;position:relative}.background-shapes{position:fixed;top:0;left:0;width:100%;height:100%;z-index:-1;overflow:hidden}.shape{position:absolute;border-radius:50%;filter:blur(120px);opacity:.5}.shape1{width:400px;height:400px;background:linear-gradient(135deg,var(--accent-color-1),var(--accent-color-2));top:10%;left:10%;animation:move-blob 15s infinite alternate ease-in-out}.shape2{width:300px;height:300px;background:linear-gradient(135deg,var(--accent-color-2),var(--accent-color-3));bottom:5%;right:15%;animation:move-blob 20s infinite alternate-reverse ease-in-out}.shape3{width:250px;height:250px;background:linear-gradient(135deg,var(--accent-color-3),var(--accent-color-1));top:50%;right:5%;animation:move-blob 18s infinite alternate ease-in-out}@keyframes move-blob{0%{transform:translate(0,0) scale(1)}100%{transform:translate(100px,-50px) scale(1.2)}}.container{max-width:1200px;margin:0 auto;padding:2rem}header{display:flex;justify-content:space-between;align-items:center;padding:1.5rem 2rem;position:sticky;top:0;z-index:10;background:var(--glass-bg);backdrop-filter:blur(15px);-webkit-backdrop-filter:blur(15px);border-bottom:1px solid var(--border-color)}.logo{font-size:1.5rem;font-weight:700;background:linear-gradient(90deg,var(--accent-color-1),var(--accent-color-3));-webkit-background-clip:text;-webkit-text-fill-color:transparent}.header-actions{display:flex;align-items:center;gap:1.5rem}.search-bar{position:relative}#search-input{background:var(--glass-bg);border:1px solid var(--border-color);color:var(--text-color);border-radius:20px;padding:.5rem 1rem .5rem 2.5rem;font-size:.9rem;transition:all .3s ease;width:200px}#search-input:focus{outline:0;box-shadow:0 0 0 3px var(--glow-color);width:250px}.search-bar svg{position:absolute;left:1rem;top:50%;transform:translateY(-50%);color:var(--text-muted);width:16px;height:16px}.theme-switch{position:relative;display:inline-block;width:50px;height:28px}.theme-switch input{opacity:0;width:0;height:0}.slider{position:absolute;cursor:pointer;top:0;left:0;right:0;bottom:0;background-color:var(--glass-bg);border:1px solid var(--border-color);transition:.4s;border-radius:34px}.slider:before{position:absolute;content:"";height:20px;width:20px;left:4px;bottom:3px;background:linear-gradient(135deg,var(--accent-color-1),var(--accent-color-2));transition:.4s;border-radius:50%}input:checked+.slider:before{transform:translateX(22px)}.upload-section{text-align:center;padding:6rem 2rem;min-height:50vh;display:flex;flex-direction:column;justify-content:center;align-items:center}.drop-zone{width:100%;max-width:500px;padding:4rem 2rem;border:2px dashed var(--border-color);border-radius:20px;background:var(--glass-bg);backdrop-filter:blur(5px);-webkit-backdrop-filter:blur(5px);transition:all .3s ease;cursor:pointer}.drop-zone.drag-over{border-color:var(--accent-color-2);transform:scale(1.02);box-shadow:0 0 30px var(--glow-color)}.upload-button{background:linear-gradient(90deg,var(--accent-color-1),var(--accent-color-2));color:#fff;padding:1rem 2rem;border:none;border-radius:50px;font-size:1.1rem;font-weight:600;cursor:pointer;transition:all .3s ease;box-shadow:0 10px 20px -5px rgba(0,0,0,.2);animation:pulse-glow 2s infinite alternate}.upload-button:hover{transform:translateY(-3px);box-shadow:0 15px 25px -5px var(--glow-color);animation-play-state:paused}.upload-text{margin-top:1.5rem;color:var(--text-muted)}@keyframes pulse-glow{from{box-shadow:0 0 15px -5px var(--glow-color)}to{box-shadow:0 0 30px 0 var(--glow-color)}}#file-input{display:none}.gallery-section{padding:2rem 0}#gallery-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:2rem}.gallery-item{background:var(--glass-bg);border-radius:16px;overflow:hidden;border:1px solid var(--border-color);backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);transition:transform .3s ease,box-shadow .3s ease;opacity:0;transform:translateY(20px);animation:fade-in-up .5s ease forwards}.gallery-item:hover{transform:translateY(-5px);box-shadow:0 10px 30px rgba(0,0,0,.1)}.image-container{position:relative;width:100%;padding-top:75%;overflow:hidden;cursor:pointer}.gallery-item img{position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;transition:filter .8s cubic-bezier(.25,1,.5,1),transform .8s cubic-bezier(.25,1,.5,1)}.gallery-item.loading .image-container::before{content:'';position:absolute;top:0;left:0;height:4px;width:0;background:linear-gradient(90deg,var(--accent-color-1),var(--accent-color-3));z-index:2;animation:progress-bar 3s ease-out forwards}.gallery-item.loading img{visibility:hidden}.gallery-item .image-container img.reveal{filter:blur(0) scale(1);opacity:1}.gallery-item .image-container img.initial{filter:blur(20px) scale(1.1);opacity:.5}@keyframes progress-bar{from{width:0%}to{width:100%}}.info-container{padding:1rem}.description{font-weight:500;margin-bottom:.75rem;color:var(--text-color)}.tags-container{display:flex;flex-wrap:wrap;gap:.5rem;transition:all .3s ease}.tag{background-color:var(--accent-color-1);color:#fff;padding:.25rem .75rem;border-radius:12px;font-size:.8rem;font-weight:500}.more-info{max-height:0;overflow:hidden;transition:max-height .5s ease-in-out,margin-top .5s ease-in-out;cursor:pointer}.gallery-item.expanded .more-info{max-height:500px;margin-top:1rem}.placeholder-text{font-size:.9rem;color:var(--text-muted);line-height:1.5}.item-actions{display:flex;justify-content:flex-end;gap:.5rem;margin-top:1rem;border-top:1px solid var(--border-color);padding-top:1rem}.action-btn{background:var(--glass-bg);border:1px solid var(--border-color);color:var(--text-muted);padding:.5rem 1rem;border-radius:8px;cursor:pointer;transition:all .2s ease;font-weight:500}.action-btn:hover{background:var(--border-color);color:var(--text-color)}#tags-editor{width:100%;background:rgba(0,0,0,.2);border:1px solid var(--border-color);color:var(--text-color);padding:.5rem;border-radius:8px;margin-top:.5rem;font-family:var(--font-main)}.lightbox{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.85);backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);z-index:1000;display:flex;justify-content:center;align-items:center;padding:2rem;opacity:0;visibility:hidden;transition:opacity .3s ease,visibility .3s ease}.lightbox.show{opacity:1;visibility:visible}.lightbox-content{position:relative;display:flex;flex-direction:column;align-items:center;gap:1rem;max-width:90vw;max-height:90vh;transform:scale(.95);transition:transform .3s ease}.lightbox.show .lightbox-content{transform:scale(1)}.lightbox-image{max-width:100%;max-height:70vh;border-radius:16px;object-fit:contain;box-shadow:0 20px 40px rgba(0,0,0,.3)}.lightbox-info{background:var(--glass-bg);border:1px solid var(--border-color);border-radius:12px;padding:1rem 1.5rem;width:100%;max-width:800px;text-align:center}.lightbox-info .description{font-size:1.1rem;font-weight:600}.lightbox-info .tags-container{justify-content:center;margin-top:.5rem}.lightbox-close,.lightbox-nav{position:absolute;background:var(--glass-bg);color:var(--text-color);border:1px solid var(--border-color);border-radius:50%;width:44px;height:44px;display:flex;justify-content:center;align-items:center;cursor:pointer;transition:all .2s ease;font-size:1.5rem}.lightbox-close:hover,.lightbox-nav:hover{background-color:var(--border-color);transform:scale(1.1)}.lightbox-close{top:-15px;right:-15px}.lightbox-nav{top:50%;transform:translateY(-50%)}.lightbox-prev{left:-60px}.lightbox-next{right:-60px}.project-actions{text-align:center;padding:4rem 2rem 2rem;border-top:1px solid var(--border-color);margin-top:4rem}.project-actions h3{margin-bottom:1.5rem;font-weight:600;font-size:1.2rem;color:var(--text-muted)}.action-buttons-container{display:flex;justify-content:center;gap:1rem;flex-wrap:wrap}@keyframes fade-in-up{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}@media (max-width:768px){.container{padding:1rem}header{flex-direction:column;gap:1rem;padding:1rem}.header-actions{width:100%;justify-content:space-between}#search-input,#search-input:focus{width:100%}.upload-section{padding:4rem 1rem}#gallery-grid{grid-template-columns:1fr}.lightbox-nav{background:rgba(30,30,40,.7)}.lightbox-prev{left:10px}.lightbox-next{right:10px}.lightbox-close{top:10px;right:10px}}</style></head><body data-theme="dark"><div class="background-shapes"><div class="shape shape1"></div><div class="shape shape2"></div><div class="shape shape3"></div></div><header><div class="logo">Aether Gallery</div><span style="font-size:.9rem;color:var(--text-muted);user-select:none;pointer-events:none">Marcelo Isaac Barraza Lucero (MFW)</span><div class="header-actions"><div class="search-bar"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"/></svg><input type="text" id="search-input" placeholder="Buscar por etiqueta..."></div><label class="theme-switch"><input type="checkbox" id="theme-toggle"><span class="slider"></span></label></div></header><main class="container"><section class="upload-section"><div id="drop-zone" class="drop-zone"><button class="upload-button">Elegir o Arrastrar Imágenes</button><p class="upload-text">Soporta PNG, JPG, WEBP</p></div><input type="file" id="file-input" multiple="multiple" accept="image/png, image/jpeg, image/webp"></section><section class="gallery-section" id="gallery-section"><div id="gallery-grid"></div></section></main><footer class="project-actions"><h3>Acciones del Proyecto</h3><div class="action-buttons-container"><button class="upload-button" id="export-zip-btn" style="animation:none;background:var(--accent-color-3)">Exportar Proyecto (.zip)</button><label class="upload-button" for="import-zip-input" style="animation:none;background:var(--accent-color-1)">Importar Proyecto (.zip)</label><input type="file" id="import-zip-input" accept=".zip" style="display:none"></div></footer><div class="lightbox" id="lightbox"><div class="lightbox-content"><img src="" alt="Vista previa de imagen" class="lightbox-image" id="lightbox-img"><div class="lightbox-info"><p class="description" id="lightbox-desc"></p><div class="tags-container" id="lightbox-tags"></div></div><div class="lightbox-close" id="lightbox-close">×</div><div class="lightbox-nav lightbox-prev" id="lightbox-prev">❮</div><div class="lightbox-nav lightbox-next" id="lightbox-next">❯</div></div></div><script src="https://cdn.jsdelivr.net/npm/onnxruntime-web@1.22.0/dist/ort.min.js"></script><script>function normalize01(n) { const o = Math.min(...n), e = Math.max(...n); return e === o ? new Float32Array(n.length).fill(.5) : new Float32Array(n.map((n => (n - o) / (e - o)))) } async function preprocessImage(n, o = 3) { return new Promise(((e, r) => { const t = new Image; t.onload = () => { const n = document.createElement("canvas"), r = 256, a = 256; n.width = a, n.height = r; const s = n.getContext("2d"); s.imageSmoothingEnabled = !0, s.drawImage(t, 0, 0, a, r); const l = s.getImageData(0, 0, a, r).data, i = new Float32Array(o * r * a); for (let n = 0; n < r; n++)for (let e = 0; e < a; e++) { const r = 4 * (n * a + e), t = n * a + e; i[t + 0] = l[r] / 255, i[t + 65536] = l[r + 1] / 255, i[t + 131072] = l[r + 2] / 255, 4 === o && (i[t + 196608] = l[r + 3] / 255) } e(i) }, t.onerror = () => { r(new Error("Error al cargar la imagen.")) }, t.src = n })) } let onnxSession = null, onnxConfig = null; async function generateTagsFromImage(n) { try { if (!onnxSession) { console.log("Cargando modelo ONNX y configuración..."); const n = "./model.onnx", o = await fetch("./config.json"); if (!o.ok) throw new Error("No se pudo cargar config.json"); onnxConfig = await o.json(), onnxSession = await ort.InferenceSession.create(n) } const o = await preprocessImage(n, 3), e = { pixel_values: new ort.Tensor("float32", o, [1, 3, 256, 256]) }, r = await onnxSession.run(e); let t = r[onnxSession.outputNames[0]].data; t = normalize01(t); const a = onnxConfig.id2label, s = 10, l = .5, i = Array.from(t).map(((n, o) => ({ idx: o, value: n }))); i.sort(((n, o) => o.value - n.value)); const c = []; for (let n = 0; n < i.length && c.length < s; n++)i[n].value >= l && c.push(i[n]); const g = c.map((n => a[n.idx.toString()])); console.log("Etiquetas generadas:", g); let m = []; g.forEach((n => { n.split(",").forEach((n => { const o = n.trim().toLowerCase(); o && (m.push(o), o.indexOf(" ") > -1 && o.split(" ").forEach((n => { (n = n.trim()) && m.push(n) }))) })) })); const f = [...new Set(m)], u = {}; f.forEach((n => { u[n] = m.filter((o => o === n)).length })); const h = g.map((n => n.toLowerCase())); let d = f.filter((n => u[n] > 1 || h.includes(n))); return 0 === d.length && (d = f), d } catch (n) { return console.error(`Error al generar etiquetas: ${n}`), ["error", "procesando"] } }</script><script>document.addEventListener("DOMContentLoaded", (() => { const e = document.getElementById("theme-toggle"), t = document.body, n = document.getElementById("drop-zone"), a = document.getElementById("file-input"), i = document.querySelector(".upload-button"), o = document.getElementById("gallery-grid"), s = document.getElementById("search-input"), d = document.getElementById("export-zip-btn"), r = document.getElementById("import-zip-input"), c = document.getElementById("lightbox"), l = document.getElementById("lightbox-img"), g = document.getElementById("lightbox-desc"), m = document.getElementById("lightbox-tags"), u = document.getElementById("lightbox-close"), f = document.getElementById("lightbox-prev"), y = document.getElementById("lightbox-next"); let p = [], v = 0, h = -1, E = 0; const L = n => { t.setAttribute("data-theme", n), e.checked = "light" === n, localStorage.setItem("aether-gallery-theme", n) }; function b(e) { for (const t of e) if (t.type.startsWith("image/")) { const e = new FileReader; e.onload = e => { const n = { id: v++, file: t, dataURL: e.target.result, description: "Descripción de la imagen...", tags: [] }; p.push(n), k(n) }, e.readAsDataURL(t) } } function k(e) { const t = document.createElement("div"); t.className = "gallery-item loading", t.dataset.id = e.id, t.dataset.tags = e.tags.join(","), t.innerHTML = `\n                <div class="image-container">\n                    <img src="${e.dataURL}" alt="${e.file.name}" class="initial">\n                </div>\n                <div class="info-container">\n                    <p class="description">${e.description}</p>\n                    <div class="tags-container"></div>\n                    <div class="more-info">\n                         <p class="placeholder-text">Haz click en la imagen para verla en grande. Edita las etiquetas abajo.</p>\n                    </div>\n                    <div class="item-actions">\n                        <button class="action-btn edit-tags-btn">Editar Etiquetas</button>\n                        <button class="action-btn delete-item-btn">Eliminar</button>\n                    </div>\n                </div>\n            `, o.appendChild(t); const n = t.querySelector("img"); setTimeout((() => { t.classList.remove("loading"), n.classList.add("reveal"), async function (e) { console.log(`Procesando imagen con IA: ${e.file.name}`); const t = await generateTagsFromImage(e.dataURL); e.tags = t, x(e.id, e.tags), console.log(`Etiquetas generadas para ${e.file.name}:`, e.tags) }(e) }), 3e3), t.querySelector(".image-container").addEventListener("click", (() => function (e) { const t = p.findIndex((t => t.id === e)); if (-1 === t) return; h = t, I(), c.classList.add("show"), document.body.style.overflow = "hidden" }(e.id))), t.querySelector(".more-info").addEventListener("click", (() => t.classList.toggle("expanded"))), t.querySelector(".edit-tags-btn").addEventListener("click", (t => function (e, t) { const n = o.querySelector(`.gallery-item[data-id="${t}"]`).querySelector(".tags-container"), a = e.target; if ("Editar Etiquetas" === a.textContent) { a.textContent = "Guardar"; const e = p.find((e => e.id === t)).tags.join(", "); n.innerHTML = `<input type="text" id="tags-editor" value="${e}">`, n.querySelector("#tags-editor").focus() } else { a.textContent = "Editar Etiquetas"; const e = n.querySelector("#tags-editor").value.split(",").map((e => e.trim())).filter(Boolean); x(t, e) } }(t, e.id))), t.querySelector(".delete-item-btn").addEventListener("click", (() => function (e) { const t = p.findIndex((t => t.id === e)); if (t > -1) { p.splice(t, 1); const n = o.querySelector(`.gallery-item[data-id="${e}"]`); n && (n.style.animation = "fade-out 0.3s ease forwards", setTimeout((() => n.remove()), 300)) } }(e.id))) } function w() { c.classList.remove("show"), document.body.style.overflow = "auto" } function I() { if (h < 0 || h >= p.length) return; const e = p[h]; l.src = e.dataURL, g.textContent = e.description, m.innerHTML = e.tags.map((e => `<span class="tag">${e}</span>`)).join("") } function S() { h = (h + 1) % p.length, I() } function q() { h = (h - 1 + p.length) % p.length, I() } function x(e, t) { const n = p.find((t => t.id === e)); if (!n) return; n.tags = t; const a = o.querySelector(`.gallery-item[data-id="${e}"]`); if (!a) return; a.dataset.tags = t.join(",").toLowerCase(); a.querySelector(".tags-container").innerHTML = t.map((e => `<span class="tag">${e}</span>`)).join("") } e.addEventListener("change", (() => L(e.checked ? "light" : "dark"))), (() => { const e = localStorage.getItem("aether-gallery-theme") || "dark"; L(e) })(), i.addEventListener("click", (() => a.click())), n.addEventListener("click", (e => { e.target !== i && a.click() })), n.addEventListener("dragover", (e => { e.preventDefault(), n.classList.add("drag-over") })), n.addEventListener("dragleave", (() => n.classList.remove("drag-over"))), n.addEventListener("drop", (e => { e.preventDefault(), n.classList.remove("drag-over"), b(e.dataTransfer.files) })), a.addEventListener("change", (() => b(a.files))), u.addEventListener("click", w), c.addEventListener("click", (e => { e.target === c && w() })), y.addEventListener("click", S), f.addEventListener("click", q), document.addEventListener("keydown", (e => { c.classList.contains("show") && ("ArrowRight" === e.key && S(), "ArrowLeft" === e.key && q(), "Escape" === e.key && w()) })), c.addEventListener("touchstart", (e => { E = e.touches[0].clientX })), c.addEventListener("touchend", (e => { const t = e.changedTouches[0].clientX - E; t > 50 ? q() : t < -50 && S() })), s.addEventListener("input", (() => { const e = s.value.toLowerCase().trim(); document.querySelectorAll(".gallery-item").forEach((t => { const n = t.dataset.tags || ""; t.style.display = n.includes(e) ? "block" : "none" })) })), d.addEventListener("click", (async () => { if (0 === p.length) return alert("No hay imágenes para exportar."); const e = new JSZip, t = []; p.forEach((n => { e.file(n.file.name, n.file), t.push({ filename: n.file.name, description: n.description, tags: n.tags }) })), e.file("project_meta.json", JSON.stringify(t, null, 2)), e.generateAsync({ type: "blob" }).then((e => { const t = document.createElement("a"); t.href = URL.createObjectURL(e), t.download = "Aether_Gallery_Project.zip", t.click(), t.remove() })) })), r.addEventListener("change", (async e => { const t = e.target.files[0]; if (!t) return; p = [], o.innerHTML = "", v = 0; const n = await JSZip.loadAsync(t), a = n.file("project_meta.json"); if (!a) return alert("Archivo .zip no válido."); const i = JSON.parse(await a.async("string")); for (const e of i) { const t = n.file(e.filename); if (t) { const n = await t.async("blob"), a = new File([n], e.filename, { type: n.type }), i = await new Promise((e => { const t = new FileReader; t.onload = t => e(t.target.result), t.readAsDataURL(a) })), o = { id: v++, file: a, dataURL: i, description: e.description, tags: e.tags }; p.push(o), k(o), setTimeout((() => x(o.id, o.tags)), 50) } } })) })); const style = document.createElement("style"); style.innerHTML = "@keyframes fade-out { from { opacity: 1; transform: scale(1); } to { opacity: 0; transform: scale(0.9); } }", document.head.appendChild(style);</script></body></html>